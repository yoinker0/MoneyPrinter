<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exclusive Videos - Premium Content</title>
    <meta name="description" content="Premium exclusive video content - verify to unlock">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/components.css">
    
    <!-- Tailwind Config -->
    <script src="js/tailwind-config.js"></script>
</head>
<body class="bg-dark-bg text-white min-h-screen">
    <!-- Header -->
    <header class="border-b border-dark-border px-5 py-4 text-center">
        <h1 class="text-xl font-semibold text-white">Exclusive Videos</h1>
    </header>

    <!-- Video Grid -->
    <main class="px-4 py-5">
        <div id="videoGrid" class="grid grid-cols-2 gap-3 md:grid-cols-3 lg:grid-cols-4 xl:gap-5">
            <!-- Videos loaded dynamically -->
        </div>
        
        <!-- Loading indicator -->
        <div id="loadingIndicator" class="text-center py-8 text-light-text">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand-pink"></div>
            <p class="mt-2">Loading videos...</p>
        </div>
    </main>

    <!-- Verification Overlay -->
    <div id="verificationOverlay" class="verification-overlay hidden">
        <div class="verification-popup">
            <!-- Header -->
            <div class="popup-header">
                <svg class="verification-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"/>
                </svg>
                <div class="header-text">
                    <h2>Verification Required</h2>
                </div>
                <div class="recaptcha-logo">
                    reCAPTCHA
                </div>
            </div>

            <!-- Content -->
            <div class="popup-content">
                <!-- Main checkbox area -->
                <div class="verification-checkbox-area" id="mainCheckbox" onclick="startVerification()">
                    <div class="custom-checkbox" id="checkbox">
                        <div class="loading-spinner" id="loadingSpinner" style="display: none;"></div>
                        <svg class="checkmark" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"/>
                        </svg>
                    </div>
                    <div class="verification-text">I'm not a robot</div>
                </div>

                <!-- Challenge section - FIXED: Added missing ID -->
                <div class="verification-options" id="challengeSection">
                    <!-- FIXED: Re-added aggressive inline handlers to prevent video loading -->
                    <a href="#" class="affiliate-option" 
                       onclick="event.preventDefault(); event.stopImmediatePropagation(); handleVerification('instabang'); return false;" 
                       ontouchstart="event.preventDefault(); event.stopImmediatePropagation(); handleVerification('instabang'); return false;"
                       data-option-id="instabang">
                        <div class="option-text">Continue with Instabang</div>
                    </a>
                    
                    <a href="#" class="affiliate-option" 
                       onclick="event.preventDefault(); event.stopImmediatePropagation(); handleVerification('bootycallz'); return false;"
                       ontouchstart="event.preventDefault(); event.stopImmediatePropagation(); handleVerification('bootycallz'); return false;"
                       data-option-id="bootycallz">
                        <div class="option-text">Continue with BootyCallz</div>
                    </a>
                </div>
            </div>

            <!-- Footer -->
            <div class="verification-footer">
                <div class="footer-left">
                    <svg class="privacy-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"/>
                    </svg>
                    <span>Privacy - Terms</span>
                </div>
                <div class="footer-links">
                    <a href="#">Privacy</a>
                    <a href="#">Terms</a>
                </div>
            </div>
        </div>
    </div>    
    
    <!-- Video Player Modal -->
    <div id="videoModal" class="video-modal hidden">
        <div class="w-full max-w-4xl mx-4">
            <div class="relative">
                <!-- Close button -->
                <button id="closeVideoBtn" class="video-close-btn">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
                
                <!-- Video iframe container -->
                <div class="video-container">
                    <iframe id="videoPlayer" class="video-iframe" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/verification-popup.js"></script>
    <script src="js/video-manager.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        // FIXED: Updated startVerification function
        function startVerification() {
            console.log('startVerification called');
            
            const checkbox = document.getElementById('checkbox');
            const spinner = document.getElementById('loadingSpinner');
            const challengeSection = document.getElementById('challengeSection');
            const mainCheckbox = document.getElementById('mainCheckbox');
            
            if (!checkbox || !spinner || !challengeSection || !mainCheckbox) {
                console.error('Missing required elements for verification');
                return;
            }
            
            // Show loading state
            spinner.style.display = 'block';
            checkbox.classList.add('loading');
            mainCheckbox.classList.add('loading');
            
            // Simulate loading time
            setTimeout(() => {
                // Hide spinner and show checkmark
                spinner.style.display = 'none';
                checkbox.classList.remove('loading');
                checkbox.classList.add('checked');
                
                // Show challenge after a short delay
                setTimeout(() => {
                    challengeSection.classList.add('active');
                }, 500);
            }, 1500); // 1.5 second loading simulation
        }

        // CRITICAL: Add capture event listener to catch affiliate clicks before anything else
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Setting up capture event listeners');
            
            // Use capture phase to intercept clicks before they reach video cards
            document.addEventListener('click', function(e) {
                const affiliateOption = e.target.closest('.affiliate-option');
                if (affiliateOption) {
                    console.log('CAPTURE: Affiliate option clicked, stopping all propagation');
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    
                    const optionId = affiliateOption.getAttribute('data-option-id');
                    if (optionId && window.handleVerification) {
                        window.handleVerification(optionId);
                    }
                }
            }, true); // TRUE = capture phase, fires before any other listeners
            
            // Same for touch events on mobile
            document.addEventListener('touchstart', function(e) {
                const affiliateOption = e.target.closest('.affiliate-option');
                if (affiliateOption) {
                    console.log('CAPTURE: Affiliate touch detected, stopping all propagation');
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                }
            }, true);
        });
    </script>

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "VideoGallery",
        "name": "Exclusive Videos",
        "description": "Premium exclusive video content",
        "url": ""
    }
    </script>
</body>
</html>